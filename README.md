# OWASP-A7-Identification-and-Authentication-Failures

ปัญหาหรือข้อผิดพลาดที่เกิดขึ้นในกระบวนการระบุและการตรวจสอบตัวตนของผู้ใช้งานในระบบความปลอดภัย ซึ่งอาจทำให้บุคคลที่ไม่ได้รับอนุญาตเข้าถึงระบบหรือข้อมูลที่ไม่เหมาะสม

ตัวอย่างของ Identification and Authentication Failures

  1.  Weak Passwords:

        -  การใช้รหัสผ่านที่อ่อนแอหรือง่ายต่อการเดา เช่น "password123", "123456", "admin123" ฯลฯ
       
  2.  No Multi-Factor Authentication (MFA):

        -  ขาดการตรวจสอบตัวตนแบบหลายขั้นตอน ทำให้มีความเสี่ยงสูงของการบุกรุกต่อระบบด้วยการทำลายรหัสผ่าน

  3.  Shared or Default Credentials:

        -  การใช้ชื่อผู้ใช้และรหัสผ่านที่ถูกแบ่งปันหรือใช้ค่าเริ่มต้น ซึ่งเป็นเป้าหมายที่ง่ายสำหรับผู้โจมตี

  4.  Insufficient Account Lockout Policies:

        -  การตั้งค่านโยบายการล็อกบัญชีที่ไม่เพียงพอ ทำให้ผู้โจมตีสามารถทำลายรหัสผ่านโดยการทดลองสุ่มได้

  5.  Session Management Issues:

        -  ปัญหาในการจัดการเซสชันที่ทำให้เซสชันยังคงใช้งานหลังจากการออกจากระบบ หรือเซสชันที่ไม่มีการตรวจสอบความถูกต้องของการเข้าถึง
      
  6.  Poor User Identification Procedures:

        -  กระบวนการระบุผู้ใช้ที่ไม่เพียงพอหรือไม่มีความปลอดภัย เช่น การใช้ข้อมูลส่วนตัวหรือรหัสที่ง่ายต่อการเดา

  7.  Lack of User Training:

        -  ขาดการฝึกอบรมผู้ใช้ในเรื่องของความปลอดภัยและการรักษาความลับของข้อมูล
          
    
Authentication Bypasses

กระบวนการหรือวิธีการที่ผู้ไม่ประสงค์ดีใช้เพื่อหลีกเลี่ยงหรือข้ามการตรวจสอบตัวตน (Authentication) ในระบบความปลอดภัย เพื่อทำให้สามารถเข้าถึงระบบหรือข้อมูลที่ไม่ได้รับอนุญาตได้โดยไม่ต้องใส่ข้อมูลรับรองตัวตนที่ถูกต้อง

ตัวอย่างของ Authentication Bypasses ได้แก่:

  1.  SQL Injection (SQLi): ผู้โจมตีสามารถใช้เทคนิค SQL Injection เพื่อข้ามการตรวจสอบตัวตนในระบบฐานข้อมูล และเข้าถึงข้อมูลที่ไม่ได้รับอนุญาต

  2.  การใช้ค่าเริ่มต้น (Default Credentials): หากระบบยังใช้รหัสผ่านหรือข้อมูลรับรองตัวตนค่าเริ่มต้น ผู้ไม่ประสงค์ดีอาจใช้ข้อมูลนี้เพื่อข้ามการตรวจสอบตัวตน

  3.  การเข้าถึงไฟล์โดยตรง (Direct Object Access): ผู้ไม่ประสงค์ดีอาจเข้าถึงไฟล์หรือเส้นทางที่ไม่ได้รับอนุญาตโดยตรง โดยข้ามการตรวจสอบตัวตนที่เกี่ยวข้อง

  4.  การโจมตี Cross-Site Scripting (XSS): ผู้โจมตีสามารถใช้ XSS เพื่อเปลี่ยนแปลงหรือโจมตีเซสชัน (Session) ของผู้ใช้ และนำเสนอข้อมูลปลอมที่ผ่านการตรวจสอบตัวตน

Insecure Login

 ปัญหาหรือข้อผิดพลาดที่เกิดขึ้นในกระบวนการล็อกอินของผู้ใช้ในระบบความปลอดภัย โดยที่มีความเสี่ยงที่ข้อมูลรับรองตัวตน (credentials) ของผู้ใช้จะถูกเปิดเผยหรือถูกโจมตีได้ง่าย ซึ่งอาจเป็นเรื่องที่ว่างเปล่าของรหัสผ่านที่อ่อนแอ, การส่งข้อมูลที่ไม่เข้ารหัสผ่านช่องทางที่ไม่ปลอดภัย, หรือการจัดการเซสชัน (session) ที่ไม่ถูกต้อง

ตัวอย่างของ Insecure Login ได้แก่:

  1.  การใช้รหัสผ่านที่อ่อนแอ

  2.  การส่งข้อมูลแบบไม่ปลอดภัย

  3.  ไม่มีการใช้ HTTPS: การใช้ HTTP แทน HTTPS

  4.  ความผิดปกติในการจัดการเซสชัน

  5.  ไม่มีการตรวจสอบและบล็อกการเข้าถึงผิดปกติ

JWT Tokens

JWT ย่อมาจาก JSON Web Token ซึ่งเป็นมาตรฐานการแลกเปลี่ยนข้อมูลระหว่างฝั่งโปรแกรมอย่างปลอดภัยบนอินเทอร์เน็ต (Internet) โดยมีรูปแบบของข้อมูลเป็น JSON (JavaScript Object Notation) ซึ่งเป็นข้อมูลที่ใช้งานง่ายและมีประสิทธิภาพ โดย JWT สามารถใช้สร้าง Token ที่ใช้ในการตรวจสอบและตรวจสอบตัวตนของผู้ใช้งาน

JWT ประกอบด้วยส่วนหลัก 3 ส่วนคือ:

  1.  Header: เป็นส่วนที่ระบุประเภทของ Token และอัลกอริทึมที่ใช้ในการเข้ารหัส (Encoding) ข้อมูล เช่น "typ": "JWT" และ "alg": "HS256" (ใช้ HMAC SHA-256 เป็นอัลกอริทึมในการเข้ารหัส)

  2.  Payload: เป็นส่วนที่บรรจุข้อมูล (Claims) ที่เกี่ยวข้องกับ Token ได้แก่ข้อมูลต่าง ๆ ที่ต้องการส่งให้กับแอปพลิเคชัน ซึ่งสามารถกำหนดได้เองตามความต้องการ เช่น ชื่อผู้ใช้, สิทธิ์การเข้าถึง, เวลาหมดอายุของ Token เป็นต้น

  3.  Signature: เป็นส่วนที่ใช้สร้างลายเซ็นดิจิตอลเพื่อยืนยันความถูกต้องของ Token โดยใช้ Secret Key (หรือ Public Key ในกรณีของ RSA) เพื่อป้องกันการปลอมแปลงของ Token

การโจมตีทาง JWT Tokens มีหลายวิธีและเทคนิคต่าง ๆ

  1.  การถูกทำลายรหัสผ่าน (Brute Force) ผู้โจมตีอาจใช้วิธีการ Brute Force โดยลองคำสั่งเดารหัสลับ (Secret Key) ที่ใช้ในการเข้ารหัสลายเซ็นของ JWT Token เพื่อหา Secret Key ที่ถูกต้องและสามารถใช้เป็นการยืนยันความถูกต้องของ Token

  2.  การแก้ไขข้อมูล (JWT Token Tampering): ผู้โจมตีอาจแก้ไขข้อมูลใน Payload ของ JWT Token เพื่อเปลี่ยนแปลงสิทธิ์การเข้าถึง หรือเพิ่มข้อมูลที่ไม่ถูกต้อง เพื่อให้ได้สิทธิ์ที่ไม่เป็นไปตามความจริง

  3.  การยึดความครอบครองของ JWT Tokens (Token Hijacking): ผู้โจมตีอาจใช้เทคนิคการยึดความครอบครอง (Session Hijacking) เพื่อขโมย JWT Tokens ที่อยู่ในการตรวจสอบตัวตน และใช้ในการปลอมแปลงตัวตนของผู้ใช้

  4.  การถูกใช้ในการสร้าง Token ปลอม (JWT Token Forgery): ผู้โจมตีอาจพยายามสร้าง JWT Tokens ปลอมโดยใช้ข้อมูลที่ได้จากการสำรวจข้อมูล หรือใช้เทคนิคการแก้ไขข้อมูลเพื่อให้ Token ปลอมนั้นมีความเชื่อถือ

  5.  การใช้แบบจำลองในการทำโจมตี (Replay Attacks): ผู้โจมตีอาจบันทึก JWT Tokens ที่ถูกส่งไปยังเซิร์ฟเวอร์ และนำ Token นั้นมาใช้ซ้ำในการโจมตี โดยไม่ต้องใช้วิธีการโจมตีใหม่

  6.  การเจาะระบบการเข้ารหัสลายเซ็น (Cryptographic Attacks): ผู้โจมตีอาจใช้เทคนิคการเจาะระบบการเข้ารหัสลายเซ็น เพื่อหาวิธีการเข้ารหัสที่อ่อนแอหรือช่องโหว่ในระบบการเข้ารหัส ซึ่งอาจช่วยให้สามารถตรวจสอบตัวตนโดยไม่ถูกต้องได้


password reset

  กระบวนการที่ผู้ใช้สามารถกู้คืนหรือเปลี่ยนรหัสผ่านของตนเองในกรณีที่ลืมหรือต้องการเปลี่ยนแปลงรหัสผ่านปัจจุบัน เป็นการทำให้ผู้ใช้สามารถเข้าถึงบัญชีของตนได้ใหม่โดยไม่ต้องพิสูจน์ตัวตนผ่านทางรหัสผ่านเก่า

ขั้นตอนในการ Reset รหัสผ่านมักจะประกอบด้วย:

  1.  การร้องขอ Reset รหัสผ่าน

  2.  การตรวจสอบความเป็นเจ้าของบัญชี

  3.  การเปลี่ยนรหัสผ่าน

การโจมตีผ่านการทำ password reset 

  1.  การร้องขอ Password Reset โดยไม่ได้รับอนุญาต (Unauthorized Password Reset): ผู้ไม่ประสงค์ดีสามารถโจมตีโดยร้องขอการ Reset รหัสผ่านของบัญชีผู้ใช้จากระบบ โดยใช้ข้อมูลที่ได้จากการสำรวจหรือทำ Social Engineering เช่น ข้อมูลส่วนตัว, คำตอบในการตอบคำถามความปลอดภัย, หรือข้อมูลอื่น ๆ เพื่อก่อกวนและเข้าถึงบัญชีผู้ใช้

  2.  การโจมตีแบบ Brute Force: การโจมตีด้วยวิธี Brute Force โดยที่ผู้ไม่ประสงค์ดีพยายามลองทุกรหัสผ่านเป็นลำดับ ๆ จนกว่าจะพบรหัสผ่านที่ถูกต้องและสามารถ Reset รหัสผ่านของบัญชีได้

  3.  การเข้าถึงข้อมูลบัญชีผู้ใช้: ผู้ไม่ประสงค์ดีอาจใช้วิธีการโจมตีอื่น ๆ เช่น การโจมตีแบบ Cross-Site Scripting (XSS) เพื่อขโมย Cookie หรือข้อมูลเซสชันแล้วนำมาใช้ในการทำ Password Reset โดยการเข้าถึงข้อมูลบัญชีผู้ใช้ที่เชื่อถือได้

การป้องกันการโจมตีผ่านการทำ Password Reset

  -  การตรวจสอบความถูกต้องของข้อมูล: ระบบควรตรวจสอบความถูกต้องของข้อมูลการ Reset รหัสผ่าน โดยการตรวจสอบว่าข้อมูลที่ร้องขอมานั้นถูกต้องและถูกต้องหรือไม่ เช่น การยืนยันตัวตนของผู้ร้องขอ

  -  การใช้ Captcha: การใช้ Captcha หรือระบบการตรวจสอบตัวตนแบบอื่น ๆ เป็นวิธีที่มีประสิทธิภาพในการป้องกันการโจมตี Brute Force โดยจำกัดจำนวนครั้งที่ผู้ใช้สามารถพยายาม Reset รหัสผ่าน

  -  การใช้ Token หรือลิงก์ที่มีอายุการใช้งาน: การสร้าง Token หรือลิงก์สำหรับการ Reset รหัสผ่านที่มีอายุการใช้งาน โดย Token หรือลิงก์จะสามารถใช้งานได้เพียงรอบเดียวหรือเฉพาะระยะเวลาที่กำหนดการให้ความสำคัญกับความปลอดภัยของข้อมูล

  -  การใช้ HTTPS: การใช้ HTTPS เพื่อป้องกันการโจมตีแบบ Man-in-the-Middle ซึ่งจะช่วยให้ข้อมูลที่ถูกส่งไปยังเซิร์ฟเวอร์มีความปลอดภัยจากการถูกแอบดักฟัง

  -  การตรวจสอบความเชื่อถือของผู้ร้องขอ: ระบบควรมีการตรวจสอบและการทำความเชื่อถือของผู้ร้องขอการ Reset รหัสผ่าน เพื่อให้แน่ใจว่าการร้องขอมานั้นมาจากผู้ที่มีสิทธิ์
     การใช้งาน Multi-Factor Authentication (MFA): การใช้งาน MFA เพื่อเพิ่มความปลอดภัยในกระบวนการ Reset รหัสผ่าน โดยจะต้องมีการยืนยันตัวตนจากหลายช่องทาง เช่น รหัสผ่าน, OTP, หรือการตรวจสอบตัวตนผ่านแอปพลิเคชัน

  -  การใช้งาน Security Questions: การตั้งคำถามความปลอดภัยที่แข็งแกร่งและไม่ง่ายต่อการเดา เพื่อใช้ในกระบวนการ Reset รหัสผ่าน

  -  การตรวจสอบและบล็อก IP ผู้ใช้: หากมีการพยายาม Reset รหัสผ่านจาก IP Address ที่ไม่เป็นปกติหรือมีการลักลอบ ระบบควรมีการตรวจสอบและบล็อกการเข้าถึงที่มีความเสี่ยง

  -  การศึกษาและการอบรม: ทีมพัฒนาระบบและผู้ดูแลระบบควรได้รับการอบรมและฝึกฝนเกี่ยวกับเทคโนโลยีและมาตรการที่เกี่ยวข้องกับการป้องกันการโจมตีผ่านการ Reset รหัสผ่านที่มีประสิทธิภาพ

Secure Passwords

  รหัสผ่านที่มีความปลอดภัยและมีความยากต่อการเดาของผู้ไม่ประสงค์ดี (attackers) 
  ซึ่งมีลักษณะที่สำคัญดังนี้:

  1.  ความยาว: รหัสผ่านควรมีความยาวเพียงพอที่จะทำให้ผู้ไม่ประสงค์ดีมีความยากต่อการเดา โดยทั่วไปแล้วความยาวของรหัสผ่านควรอยู่ในช่วง 8-16 ตัวอักษรขึ้นไป

  2.  ประสิทธิภาพของอักขระ: รหัสผ่านควรประกอบไปด้วยอักขระต่าง ๆ เช่น ตัวอักษรพิมพ์ใหญ่-เล็ก, ตัวเลข, และอักขระพิเศษ เพื่อเพิ่มความยากในการเดา

  3.  ความสุ่ม: รหัสผ่านควรมีความสุ่มและไม่ซ้ำกันในบัญชีอื่น ๆ ของผู้ใช้เดียวกัน เพื่อป้องกันการโจมตีด้วยวิธีการพยายามเดารหัสผ่านแบบ Brute Force

  4.  ความลับ: รหัสผ่านควรเป็นความลับและไม่ควรสาธารณะเป็นเสียง เช่น ไม่ใช้ข้อมูลส่วนตัวเช่น ชื่อ, วันเกิด, หรือข้อมูลที่ง่ายต่อการค้นหา

  5.  การเปลี่ยนรหัสผ่าน: ผู้ใช้ควรปรับปรุงรหัสผ่านอย่างสม่ำเสมอ เพื่อป้องกันการโจมตีแบบล่วงหน้าหรือการเดารหัสผ่านที่อาจเกิดขึ้น

  6.  การใช้ Multi-Factor Authentication (MFA): การใช้ MFA เพื่อเพิ่มชั้นความปลอดภัยเพิ่มเติมโดยต้องให้การยืนยันตัวตนจากหลายช่องทาง เช่น รหัส OTP หรือการยืนยันตัวตนผ่านแอปพลิเคชัน

Video การทำ Authentication Bypasses : https://www.youtube.com/watch?v=hrEB9L2oyic

Video การทำ Insecure Login : https://www.youtube.com/watch?v=H-AFrYqFepw

Video การทำ JWT tokens : https://www.youtube.com/watch?v=ZHYYRFMG3bg

Video การทำ Password reset : https://www.youtube.com/watch?v=sH0qu2awxZs

Video การทำ Secure Passwords : https://www.youtube.com/watch?v=NpMq6MRq35Q
